

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>Wavelets II - Vanishing Moments and Spectral Factorization - Vincent Herrmann</title>







<meta property="og:locale" content="en">
<meta property="og:site_name" content="Vincent Herrmann">
<meta property="og:title" content="Wavelets II - Vanishing Moments and Spectral Factorization">


  <link rel="canonical" href="http://vincentherrmann.github.io/wavelet-construction-and-spectral-factorization/">
  <meta property="og:url" content="http://vincentherrmann.github.io/wavelet-construction-and-spectral-factorization/">



  <meta property="og:description" content="In the previous blog post I described the workings of the Fast Wavelet Transform (FWT) and Multiresolution Analysis (MRA). We saw that the scaling function $\phi$ and the wavelet function $\psi$ are defined by the filter coefficients $h_0$ by the dilation/refinement equations:">





  

  



  <meta property="og:image" content="http://vincentherrmann.github.io/images/db6SynthesisSum.png">



  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2016-09-19T15:40:52+02:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Vincent Herrmann",
      "url" : "http://vincentherrmann.github.io",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="http://vincentherrmann.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Vincent Herrmann Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="http://vincentherrmann.github.io/assets/css/main.css">

<meta http-equiv="cleartype" content="on">
    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="http://vincentherrmann.github.io/">Vincent Herrmann</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://vincentherrmann.github.io/about/">About</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://vincentherrmann.github.io/piano/">Piano</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://vincentherrmann.github.io/composition/">Composition</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://vincentherrmann.github.io/blog/">Blog</a></li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    





<div id="main" role="main">
  


  <div class="sidebar sticky">
  



<div itemscope itemtype="http://schema.org/Person">

  <div class="author__avatar">
    
    	<img src="http://vincentherrmann.github.io/images/profil-picture.jpg" class="author__avatar" alt="Vincent Herrmann">
    
  </div>

  <div class="author__content">
    <h3 class="author__name">Vincent Herrmann</h3>
    <p class="author__bio">Classically trained pianist and composer exploring the world of artificial intelligence</p>
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li><i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> Stuttgart, Germany</li>
      
      
      
      
      
        <li><a href="https://twitter.com/@herrmannvincent"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
      
      
      
      
      
      
      
      
      
        <li><a href="https://github.com/vincentherrmann"><i class="fa fa-fw fa-github" aria-hidden="true"></i> Github</a></li>
      
      
      
      
      
      
      
      
      
      
      
      
      
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Wavelets II - Vanishing Moments and Spectral Factorization">
    <meta itemprop="description" content="In the previous blog post I described the workings of the Fast Wavelet Transform (FWT) and Multiresolution Analysis (MRA). We saw that the scaling function $\phi$ and the wavelet function $\psi$ are defined by the filter coefficients $h_0$ by the dilation/refinement equations:">
    <meta itemprop="datePublished" content="September 19, 2016">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Wavelets II - Vanishing Moments and Spectral Factorization
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        <p>In the previous blog post I described the workings of the Fast Wavelet Transform (FWT) and Multiresolution Analysis (MRA). We saw that the scaling function $\phi$ and the wavelet function $\psi$ are defined by the filter coefficients $h_0$ by the dilation/refinement equations:</p>

<script type="math/tex; mode=display">\phi(t) = \sum\limits_k h_0(k) \phi(2t-k)</script>

<script type="math/tex; mode=display">\psi(t) = \sum\limits_k h_1(k) \phi(2t-k)</script>

<h2 id="vanishing-moments">Vanishing Moments</h2>

<p>The idea of vanishing moments is closely linked to the filter bank implementation. The signal is split in two parts, one part that was analyzed with $\psi$ and one that was analyzed with $\phi$. If $\psi$ is orthogonal to the signal $x(t)$, i.e. $\int x(t) \psi(-t) \mathrm{d}t = 0$, the whole signal is represented by the $\phi$ half and can nevertheless be perfectly reconstructed. This scenario is of course great for compression, and in general for data manipulation or analysis. So one measure of quality of the wavelet function $\psi$ is, to how many important functions it stands orthogonal to. In the case of so-called vanishing moments these important target function are polynoms.</p>

<p>The $n$th moment of a function $f$ is defined as:</p>

<script type="math/tex; mode=display">M_n(f) = \int t^n f(t) \mathrm{d}t</script>

<p>If this moment vanishes, then $f(t)$ is orthogonal to $t^n$. If we say a function has $A$ vanishing moments, we usually mean it has vanishing moments $M_n = 0$ for $n=0, 1, …,  A-1$. Because of the linearity of the integration operation, this means that the function is orthogonal to all polynoms up to degree $A$:</p>

<script type="math/tex; mode=display">\int \sum\limits_{n=0}^{A-1} c_n t^n f(t) \mathrm{d}t = \sum\limits_{n=0}^{A-1} c_n M_n(f)= 0</script>

<p>Polynoms of high degrees can approximate many different signals. This means, a wavelet function with many vanishing moments stands orthogonal or almost orthogonal to a wide range of different signals. The corresponding scaling function $\phi$ in turn has the expressive power to reconstruct all these signals. The downside is, as it turns out, that for more vanishing moments we need longer filters in the filter bank implementation.</p>

<p>The Daubechies 6 wavelets have three vanishing moments (we will se shortly how to construct them). This means, the Db6 scaling functions by them self can produce all polynoms with a degree up to two. In the next picture, I have analyzed some quadratic polynom with the Db6 scaling function and plotted some synthesis scaling functions shifted and scaled by the computed coefficients.</p>

<!-- ![image](/images/db6SynthesisFunctions.png) -->

<figure class=" ">
  
    
      <img src="http://vincentherrmann.github.io/images/db6SynthesisFunctions.png" alt="" />
    
  
  
    <figcaption>Fig.1: A quadratic signal and DB6 synthesis scaling functions
</figcaption>
  
</figure>

<p>It seems a bit strange that these odd, spiky shapes sum up to a smooth parable. But if we add one at a time, we see that see fit like pieces of a puzzle to create a (shifted) section of the original function.</p>

<!-- ![image](/images/db6SynthesisSum.png) -->

<figure class=" ">
  
    
      <img src="http://vincentherrmann.github.io/images/db6SynthesisSum.png" alt="" />
    
  
  
    <figcaption>Fig.2: The DB6 synthesis scaling function added together
</figcaption>
  
</figure>

<h2 id="connection-to-filter-coefficients">Connection to Filter Coefficients</h2>

<p>Now we have new criteria for our scaling- and wavelet-function. But in a FWT setting, our functions are defined through the filter coefficients $h_0$ and $h_1$, where $h_1(k) = (-1)^k h_0(k)$. For the next part, we will only use $h_1$, so let’s call it only $h$ for now. So how do we translate the idea of vanishing moments into constraints for these coefficients? First we plug the wavelet equation into the definition of the vanishing moments:</p>

<script type="math/tex; mode=display">M_n(\psi) = \int t^n \sum\limits_k h(k) \phi(2t-k) \mathrm{d}t = 0</script>

<p>We assume that $\phi$ has the necessary moments, but they are not zero. Now we create a new variable $s_k = 2t-k$:</p>

<script type="math/tex; mode=display">M_n(\psi) = \int (\frac{s_k + k}{2})^n \sum\limits_k h(k) \phi(s_k) \mathrm{d}s_k</script>

<script type="math/tex; mode=display">= \sum\limits_k h(k) \int (\frac{s_k + k}{2})^n \phi(s_k) \mathrm{d}s_k = 0</script>

<p>Let’s look at the $0$th moment:</p>

<script type="math/tex; mode=display">M_0(\psi) = \sum\limits_k h(k) \int \phi(s_k) \mathrm{d}s_k = \sum\limits_k h(k) M_0(\phi(s_k)) = 0</script>

<p>The integral  $\int \phi(s_k) \mathrm{d}s_k = \int \phi(2t-k) \mathrm {d}t$ is invariant to changes in $k$, so $M_n(\phi(s_k))$ is constant for all $k$. With that, the requirement for one vanishing moment is:</p>

<script type="math/tex; mode=display">\sum\limits_k h(k) = 0</script>

<p>Now we can go on with vanishing moment $1$:</p>

<script type="math/tex; mode=display">M_1(\psi) = \sum\limits_k h(k) \int (\frac{1}{2} s_k \phi(s_k) +  \frac{1}{2} k \phi(s_k)) \mathrm{d}s_k</script>

<script type="math/tex; mode=display">= \sum\limits_k h(k) (\frac{1}{2} k M_0(\phi(s_k)) + \frac{1}{2} M_1(\phi(s_k))) = 0</script>

<p>The second term $\sum_k h(k) \frac{1}{2} M_1(\phi(s_k))$ is zero, we know that from the condition for the $0$th vanishing moment. From the second term $\sum_k h(k) \frac{1}{2} k M_0(\phi(s_k)) = 0$ follows the new condition for vanishing moment $1$:</p>

<script type="math/tex; mode=display">\sum\limits_k k h(k) = 0</script>

<p>And vanishing Moment $2$:</p>

<script type="math/tex; mode=display">M_2(\psi) = \sum\limits_k h(k) \int \frac{1}{4} s_k^2 \phi(s_k) +  \frac{1}{2} k \phi(s_k) + \frac{1}{4} k^2 \phi(s_k)\mathrm{d}s_k</script>

<script type="math/tex; mode=display">= \sum\limits_k h(k) (\frac{1}{4} k^2 M_0(\phi(s_k)) + \frac{1}{2} k M_1(\phi(s_k))  + \frac{1}{4} M_2(\phi(s_k))) = 0</script>

<p>Now the second and third term are both zero, based on the previous conditions. And the new condition for vanishing moment $2$ is:</p>

<script type="math/tex; mode=display">\sum\limits_k k^2 h(k) = 0</script>

<p>For every new vanishing moment $n$, there will be a term proportional to $\sum_k h(k) k^n M_n(\phi(s_k))$. All other terms will have a factor $k^m$ with $m&lt;n$, those will automatically zero, based on the previous conditions. With that we have the condition for filter coefficients $h$ of a wavelet function $\psi$ with $A$ vanishing moments:</p>

<script type="math/tex; mode=display">\sum\limits_k k^n h(k) = 0; \: \: n = 0, 1, ..., A-1</script>

<h2 id="construction-in-the-fourier-domain">Construction in the Fourier Domain</h2>

<p>Now we have all the conditions to construct useful wavelets. Unfortunately, this construction is probably the fiddliest part.</p>

        
      </section>

      <footer class="page__meta">
        
        




        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2016-09-19T15:40:52+02:00">September 19, 2016</time></p>
        
      </footer>

      

<section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=http://vincentherrmann.github.io/wavelet-construction-and-spectral-factorization/" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http://vincentherrmann.github.io/wavelet-construction-and-spectral-factorization/" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=http://vincentherrmann.github.io/wavelet-construction-and-spectral-factorization/" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://vincentherrmann.github.io/wavelet-construction-and-spectral-factorization/" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>

      


  <nav class="pagination">
    
      <a href="http://vincentherrmann.github.io/test-post/" class="pagination--pager" title="Test Post
">Previous</a>
    
    
      <a href="http://vincentherrmann.github.io/filter-banks,-MRA-and-the-wavelet-dilation-equation/" class="pagination--pager" title="Wavelets I - From Filter Banks to the Dilation Equation
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
    
    
      <li><a href="http://github.com/vincentherrmann"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="http://vincentherrmann.github.io/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2016 Vincent Herrmann. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>
      </footer>
    </div>

    <script src="http://vincentherrmann.github.io/assets/js/main.min.js"></script>

<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<script type="text/javascript">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],

    "HTML-CSS": {
      minScaleAdjust: 50,
      scale: 90,
      availableFonts: ["TeX"],
      preferredFont: "TeX",
      mtextFontInherit: false,
      matchFontHeight: true,
    },

    tex2jax: {
      inlineMath: [['$','$']]
    }
  });
</script>

<!-- <script src="MathJax.Hub.Config(
  { extensions: ["MatchWebFonts.js"],

  MatchWebFonts: {
    matchFor: {
      "HTML-CSS": true,
      NativeMML: false,
      SVG: false
    },
    fontCheckDelay: 20000,
    fontCheckTimeout: 300 * 1000
  },
  tex2jax: {
    inlineMath: [['\\(','\\)']]
  },

  "HTML-CSS": {
    linebreaks: {
      automatic: true
    },
    scale: 40,
    preferredFont: "TeX",
    mtextFontInherit: true,
    matchFontHeight: true
  }

});" type="text/javascript" ></script> -->





  </body>
</html>
